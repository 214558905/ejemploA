<div class="fondo" fxLayout="column" fxLayoutAlign="space-between">

    <div>
        <app-header></app-header>
    </div>
    <div class="contenido" fxLayoutAlign="center center">
       <div class="loginR" >
        <div class="logo" fxLayoutAlign="center center">
            <img src="../../assets/logoUnibe2.png" alt="">

        </div>
        <span class="helvetica" fxLayoutAlign="center center" >Cambiar Contraseña</span>
        <form #formPass="ngForm">
            <div class="form-group">
              <label for="password">Contraseña</label>
              <div fxLayout="row">
                <input 
                type="{{ showResetPassword ? 'text' : 'password' }}"class="form-control"  
                pattern="^(?=.*[A-Z])(?=.*\d).{8,}$"
                id="password"
                #password="ngModel"
                [(ngModel)]="contrasena"
                [ngClass]="
                valido && formPass.controls['password'].invalid
                  ? 'is-invalid'
                  : ''
              "
                name="password" required>
                <span class="input-group-text" (click)="showResetPassword = !showResetPassword">
                  <i [ngClass]="showResetPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                </span>
              </div>
              <small
                *ngIf="formPass.controls['password']?.errors?.['pattern']"
              >
                <label for="" class="inputInvalido"
                  >La contraseña debe contener almenos una letra mayuscula y un número y mas de 8 caracteres</label
                >
              </small>
              <small
              *ngIf="valido && formPass.controls['password'].invalid && !formPass.controls['password']?.errors?.['pattern']"
            >
              <label for="" class="inputInvalido"
                >Este campo es requerido</label
              >
            </small>
            </div>
            <div class="form-group">
              <label for="confirmPassword">Repetir Contraseña</label>
              <div fxLayout="row">
                <input type="{{ showPassword ? 'text' : 'password' }}"class="form-control"
                 id="confirmPassword" name="confirmPassword"
                 #confirmPassword="ngModel"
                 [ngClass]="
                valido && formPass.controls['confirmPassword'].invalid
                  ? 'is-invalid'
                  : ''
               "
                 [(ngModel)]="confirmContrasena"
                required>
                <span class="input-group-text" (click)="showPassword = !showPassword">
                  <i [ngClass]="showPassword ? 'fas fa-eye-slash' : 'fas fa-eye'"></i>
                </span>
              </div>
              <small
                *ngIf="contrasena != confirmContrasena && !formPass.controls['confirmPassword'].pristine"
              >
                <label for="" class="inputInvalido"
                  >Las contraseñas no coinciden</label
                >
              </small>
              <small
              *ngIf="valido && formPass.controls['confirmPassword'].invalid"
            >
              <label for="" class="inputInvalido"
                >Este campo es requerido</label
              >
            </small>
             
          
            </div>
            <div fxLayoutAlign="center center">

                <button  type="submit" (click)="changePassword(formPass)" class="my-button">Restablecer Contraseña</button>
            </div>
          </form>
       </div>
    </div>
    <div class="footer">
        <app-footer></app-footer> 
    </div>
</div>

<p-dialog [modal]="true" [visible]="visible" [style]="{ width: '50vw' }" [draggable]="false" [resizable]="false" [closable]="false" >
  <ng-template pTemplate="header">
    <div fxLayoutAlign="center center" style="width: 100%;">
      <span class="helvetica">Contraseña Modificada</span>
    </div>
  </ng-template>
  <div class="iconOk" style="width: 100%;" fxLayout="row" fxLayoutAlign="center center">
    <div style="padding-right: 5vh;">
      <i class="fa-solid fa-circle-check"></i>   
    </div>
    <div fxLayoutAlign="center center" >
      <span class="confirmaEnvio">La contraseña ha sido modificada con exito</span>
    </div>
  </div>
  <div class="confirm" fxLayoutAlign="center center">
    <a routerLink="/login" >
      <button style="width: 20vh;" class="my-button">Ok</button>
    </a>
    
  </div>
</p-dialog>